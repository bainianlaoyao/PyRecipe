"""
生成Markdown菜谱文档 - 示例程序

演示如何将程序定义的菜谱转换为Markdown格式的菜谱文档
"""

import sys
import os

# 添加父目录到路径
sys.path.insert(0, os.path.dirname(os.path.dirname(os.path.abspath(__file__))))

from 菜谱框架 import *
from 菜谱框架.markdown生成器 import (
    Markdown菜谱生成器,
    生成菜谱文档,
    生成所有菜谱,
    预览菜谱,
)


# ============================================================================
# 定义一些示例菜谱
# ============================================================================

@定义菜谱("简单炒蛋")
def 简单炒蛋(菜: 菜谱构建器):
    """简单炒蛋"""
    鸡蛋 = 菜.取食材("鸡蛋", 个(3))
    油 = 菜.取食材("油", 克(10))
    盐 = 菜.取食材("盐", 克(2))

    打散的蛋 = 菜.自定义([鸡蛋], "打散", "打散的鸡蛋")
    炒蛋 = 菜.炒([打散的蛋], 时间_秒=60, 用油=10, 名称="炒鸡蛋")
    最终 = 菜.调味([炒蛋], ["盐"], "简单炒蛋")

    return 最终


@定义菜谱("西红柿鸡蛋汤")
def 西红柿鸡蛋汤(菜: 菜谱构建器):
    """西红柿鸡蛋汤"""
    西红柿 = 菜.切(菜.取食材("西红柿", 个(2)), "块")
    鸡蛋 = 菜.取食材("鸡蛋", 个(2))
    水 = 菜.取食材("水", 毫升(500))
    油 = 菜.取食材("油", 克(5))
    盐 = 菜.取食材("盐", 克(2))
    葱花 = 菜.切(菜.取食材("葱", 根(1)), "花")

    炒西红柿 = 菜.炒([西红柿], 时间_秒=30, 用油=5, 名称="炒西红柿")
    加水 = 菜.自定义([炒西红柿, 水], "加水", "西红柿汤底")
    煮汤 = 菜.炖([加水], 时间_秒=180, 名称="煮开的汤")

    打散的蛋 = 菜.自定义([鸡蛋], "打散", "蛋液")
    蛋花 = 菜.自定义([打散的蛋, 煮汤], "淋入汤中", "蛋花汤")
    最终 = 菜.调味([蛋花, 葱花], ["盐"], "西红柿鸡蛋汤")

    return 最终


@定义菜谱("蒸蛋羹")
def 蒸蛋羹(菜: 菜谱构建器):
    """蒸蛋羹"""
    鸡蛋 = 菜.取食材("鸡蛋", 个(2))
    水 = 菜.取食材("温水", 毫升(150))
    盐 = 菜.取食材("盐", 克(1))
    酱油 = 菜.取食材("生抽", 毫升(5))
    香油 = 菜.取食材("香油", 毫升(2))

    蛋液 = 菜.自定义([鸡蛋], "打散", "蛋液")
    蛋水混合 = 菜.混合([蛋液, 水], "蛋液和温水1.5:1混合", "蛋水混合液")
    加盐的蛋液 = 菜.调味([蛋水混合], ["盐"], "调味蛋液")

    蒸制 = 菜.自定义([加盐的蛋液], "蒸10-15分钟", "蒸蛋羹")
    最终 = 菜.自定义([蒸制, 酱油, 香油], "淋上生抽和香油", "蒸蛋羹")

    return 最终


# ============================================================================
# 示例函数
# ============================================================================

def 示例1_预览单个菜谱():
    """示例1: 预览单个菜谱"""
    print("\n" + "=" * 60)
    print("示例1: 预览单个菜谱")
    print("=" * 60)

    预览菜谱("简单炒蛋")


def 示例2_生成单个菜谱文件():
    """示例2: 生成单个菜谱的Markdown文件"""
    print("\n" + "=" * 60)
    print("示例2: 生成单个菜谱文件")
    print("=" * 60)

    # 生成菜谱文档
    文档内容 = 生成菜谱文档(
        "西红柿鸡蛋汤",
        输出文件="菜谱文档/西红柿鸡蛋汤.md",
        包含统计=True
    )

    print("\n生成的文档内容预览:")
    print(文档内容[:200] + "...")


def 示例3_批量生成所有菜谱():
    """示例3: 批量生成所有菜谱"""
    print("\n" + "=" * 60)
    print("示例3: 批量生成所有菜谱")
    print("=" * 60)

    # 方式1: 每个菜谱单独文件
    print("\n方式1: 每个菜谱单独文件")
    生成所有菜谱(
        输出目录="菜谱文档/单独文件",
        单文件=False
    )

    # 方式2: 合并到一个文件
    print("\n方式2: 合并到一个文件")
    生成所有菜谱(
        输出目录="菜谱文档",
        单文件=True
    )


def 示例4_自定义菜谱集():
    """示例4: 生成自定义菜谱集"""
    print("\n" + "=" * 60)
    print("示例4: 生成自定义菜谱集")
    print("=" * 60)

    生成器 = Markdown菜谱生成器()

    # 选择要生成的菜谱
    自定义菜谱列表 = [
        "简单炒蛋",
        "西红柿鸡蛋汤",
        "蒸蛋羹",
    ]

    生成器.批量生成菜谱文档(
        自定义菜谱列表,
        输出目录="菜谱文档/鸡蛋料理集",
        单文件=True
    )


def 示例5_列出所有菜谱():
    """示例5: 列出所有已注册的菜谱"""
    print("\n" + "=" * 60)
    print("示例5: 列出所有已注册的菜谱")
    print("=" * 60)

    生成器 = Markdown菜谱生成器()
    菜谱列表 = 生成器.列出所有菜谱()

    print(f"\n共找到 {len(菜谱列表)} 个菜谱:")
    for 索引, 菜谱名 in enumerate(菜谱列表, 1):
        print(f"{索引}. {菜谱名}")


# ============================================================================
# 主函数
# ============================================================================

def main():
    """主函数"""
    print("=" * 60)
    print("Markdown菜谱生成器 - 示例程序")
    print("=" * 60)

    # 运行所有示例
    示例1_预览单个菜谱()
    示例2_生成单个菜谱文件()
    示例3_批量生成所有菜谱()
    示例4_自定义菜谱集()
    示例5_列出所有菜谱()

    print("\n" + "=" * 60)
    print("所有示例运行完成！")
    print("=" * 60)
    print("\n生成的菜谱文档位于 '菜谱文档' 目录")
    print("你可以用任何Markdown查看器打开这些文件")


if __name__ == "__main__":
    main()
